    $(document).ready(function()
    {
      var piedata = GetPieChartData();

      var title       = piedata.title;
      var itemNames   = piedata.itemNames;
      var itemColours = piedata.itemColours;
      var itemValues  = piedata.itemValues;

      // Convert the autogenerated data above into the format we need for this chart
      var data = [];
      for (x = 0; x < itemValues.length; ++x)
      {
        data.push([itemNames[x], itemValues[x] ]);
      }

      var legendtext= [];
      for (x = 0; x < itemValues.length; ++x)
      {
        legendtext.push(itemValues[x] + " " + itemNames[x]);
      }

    
      //  Draw the chart itself
      var plot1 = jQuery.jqplot ('issue_category_chart', [data], 
      { 
        title:
        {
          text: ''
        },

        seriesColors: itemColours,

        seriesDefaults:
        {
          // Make this a pie chart.
          renderer: jQuery.jqplot.PieRenderer, 
          rendererOptions:
          {
            // Put data labels on the pie slices.
            // By default, labels show the percentage of the slice, but we've customised this (see pointtext above)
            //TODO: figure out a better way to change the text colour (pref on a per-slice basis) or turn off the data labels
            //dataLabelThreshold: 0, 
            showDataLabels: true, 
            dataLabels: legendtext, 
            dataLabelFormatString: "%s"
          }
        }, 
        
        legend:
        {
          show: true,
          location: 'e',
          placement: 'insideGrid',
          labels: legendtext
        }
      });


      $('#issue_category_chart').bind('jqplotDataMouseOver', 
        function (ev, seriesIndex, pointIndex, data)
        {
          $('#info1').html('series: '+seriesIndex+', point: '+pointIndex+', data: '+data);
        }
      );


      $('#issue_category_chart').bind('jqplotDataUnhighlight', 
        function (ev)
        {
          $('#info1').html('');
          $('#info2').html('');
        }
      );


      $('#issue_category_chart').bind('jqplotDataClick', 
        function (ev, seriesIndex, pointIndex, data)
        {
          $('#info2').html('series: '+seriesIndex+', point: '+pointIndex+', data: '+data);
        }
      );
      
      
      $(window).resize(function()
      {
        plot1.replot( { resetAxes: true } );
      });

    });
